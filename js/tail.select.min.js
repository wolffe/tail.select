const tail={select:function(e,t={}){const I={multiTags:!1,multiCounter:!0,ajaxUrl:null,theme:"light",classNames:"tail-default",strings:{all:"All",none:"None",placeholder:"Select an option...",search:"Type in to search..."},...t},{ajaxUrl:M,strings:$}=I;document.querySelectorAll(e).forEach(o=>{o.style.display="none";const t=document.createElement("div"),d=(t.classList.add("tail-select"),t.classList.add(o.id),t.classList.add(I.classNames),t.dataset.theme="tail-theme--"+I.theme,o.multiple?t.classList.add("tail--multiple"):t.classList.add("tail--single"),document.createElement("input"));d.type="text",d.classList.add("tail--search"),d.placeholder=$.placeholder||"Select an option...",d.addEventListener("focus",()=>{d.placeholder=$.search||"Type in to search...",d.select()}),d.addEventListener("blur",()=>{d.placeholder=$.placeholder||"Select an option..."}),d.addEventListener("input",()=>{{var e;const l=d.value.trim().toLowerCase(),t=i.querySelectorAll("div");t.forEach(e=>{var t=e.querySelector('input[type="checkbox"]'),n=t.nextElementSibling.textContent.toLowerCase().includes(l),t=t.checked;e.style.display=t||n?"":"none"}),t.forEach(e=>{var t=e.querySelector('input[type="checkbox"]'),n=e.closest("div"),e=0<e.querySelectorAll('div input[type="checkbox"]:not([style="display: none;"])').length;n.style.display="inline-block"===t.style.display||e?"block":"none"})}});var e=document.createElement("div");e.classList.add("tail--toolbar");const a=document.createElement("input");a.type="checkbox",a.value=$.all||"All",a.addEventListener("change",()=>{{var t=o,e;const n=a.checked,l=i.querySelectorAll('input[type="checkbox"]');l.forEach(e=>{e.checked=n,c(t,e)})}});var n=document.createElement("label"),l=(n.textContent=$.all||"All",n.classList.add("all"),n.appendChild(a),document.createElement("button"));l.type="button",l.textContent=$.none||"None",l.classList.add("uncheck"),l.addEventListener("click",()=>{var t=o,n=(i.querySelectorAll('input[type="checkbox"]').forEach(e=>{e.checked=!1,c(t,e)}),t.getElementsByTagName("option"));for(let e=0;e<n.length;e++)n[e].selected=!1}),I.multiCounter&&((v=document.createElement("span")).textContent="0",v.classList.add("tail--counter"),t.appendChild(v));const i=document.createElement("div"),r=(i.classList.add("tail--nested-dropdown"),i.style.display="none",t.appendChild(d),t.appendChild(e),t.appendChild(i),e.appendChild(n),e.appendChild(l),o.insertAdjacentElement("afterend",t),document.createElement("ul"));function s(e){o.multiple||(i.querySelectorAll('.tail--nested-dropdown-item input[type="checkbox"]').forEach(e=>e.checked=!1),e.checked=!0),c(o,e)}function c(e,t){const n=t.value;for(var l=Array.from(e.options).find(e=>e.value===n||e.textContent===n),t=(l&&(l.selected=t.checked,l=new Event("change",{bubbles:!0}),e.dispatchEvent(l)),Array.from(e.options).filter(e=>e.selected)),a=(e.multiple?d.value=t.map(e=>e.textContent).join(", "):0<t.length&&d?d.value=t[0].textContent:d.value="",I.multiTags&&e.multiple&&p(r,t),t.map(e=>e.value),e.options),c=0;c<a.length;c++)a[c].selected&&0;I.multiCounter&&h(e)}function p(n,e){n.innerHTML="",e.forEach(e=>{var t=document.createElement("li");t.textContent=e.textContent,n.appendChild(t)})}function u(e){var t=Array.from(e.options).filter(e=>e.selected&&e.hasAttribute("selected"));e.multiple?d.value=t.map(e=>e.textContent).join(", "):0<t.length&&d?d.value=t[0].textContent:d.value="",I.multiTags&&e.multiple&&p(r,t)}function h(e){var t=document.querySelector(`.${e.id} .tail--counter`);t&&(e=Array.from(e.options).filter(e=>e.selected).length,t.textContent=e)}function m(){i.style.display="none",t.setAttribute("aria-expanded","false")}r.classList.add("tail--selected-options-list"),I.multiTags&&o.multiple&&t.insertAdjacentElement("afterend",r),d.addEventListener("focus",function(){i.style.display="block",t.setAttribute("aria-expanded","true")}),document.addEventListener("click",function(e){t.contains(e.target)||m()}),document.addEventListener("keydown",function(e){"Escape"===e.key&&m()});var v=document.createDocumentFragment(),y=o.getElementsByTagName("optgroup");if(0<y.length)for(let e=0;e<y.length;e++){var E=y[e],C=document.createElement("div"),x=(C.classList.add("tail--optgroup"),document.createElement("label"));const U=document.createElement("input");U.type="checkbox",U.value=E.label,U.addEventListener("change",()=>{{var t=U,e;const n=t.checked,l=t.closest(".tail--optgroup").querySelector(".tail--nested-dropdown-list"),a=l.querySelectorAll('input[type="checkbox"]');a.forEach(e=>{e.checked=n,s(e)}),o.multiple||(e=o.closest(".tail-select"))&&e.querySelectorAll('.tail--nested-dropdown-item input[type="checkbox"]').forEach(e=>{e!==t&&(e.checked=!1,c(o,e))}),c(o,t)}}),x.appendChild(U);var b=document.createElement("span"),f=(b.textContent=E.label,b.classList.add("tail--optgroup-label"),x.appendChild(b),C.appendChild(x),document.createElement("div")),g=(f.setAttribute("role","listbox"),f.classList.add("tail--nested-dropdown-list"),E.getElementsByTagName("option"));for(let e=0;e<g.length;e++){var k=g[e],L=document.createElement("div"),A=(L.classList.add("tail--nested-dropdown-item"),document.createElement("input")),S=(A.type="checkbox",A.value=k.textContent,document.createElement("label")),q=document.createElement("span");q.textContent=k.textContent,k.dataset.description&&(q.innerHTML+=`<small>${k.dataset.description}</small>`),k.selected&&k.hasAttribute("selected")&&(A.checked=!0,h(o),u(o)),S.appendChild(A),S.appendChild(q),L.appendChild(S),f.appendChild(L)}C.appendChild(f),i.appendChild(C)}else{var w=o.getElementsByTagName("option");for(let e=0;e<w.length;e++){var T=w[e],j=document.createElement("div"),N=(j.classList.add("tail--nested-dropdown-item"),document.createElement("input")),B=(N.type="checkbox",N.value=T.textContent,document.createElement("label")),H=document.createElement("span");H.textContent=T.textContent,T.dataset.description&&(H.innerHTML+=`<small>${T.dataset.description}</small>`),T.selected&&T.hasAttribute("selected")&&(N.checked=!0,h(o),u(o)),B.appendChild(N),B.appendChild(H),j.appendChild(B),i.appendChild(j)}}t.setAttribute("role","combobox"),t.setAttribute("aria-haspopup","true"),t.setAttribute("aria-expanded","false"),i.querySelectorAll('.tail--nested-dropdown-item input[type="checkbox"]').forEach(e=>{e.addEventListener("change",()=>s(e))}),i.appendChild(v),M&&d.addEventListener("input",function(){var e,t;[e=""]=[this.value],(t=I.ajaxUrl)&&e&&(t+="?term="+encodeURIComponent(e),fetch(t).then(e=>e.json()).then(e=>{{e=e.results;const d=[];i.querySelectorAll('input[type="checkbox"]:checked').forEach(e=>{d.push(parseInt(e.value,10))}),i.querySelectorAll(".tail--nested-dropdown-item").forEach(e=>{const t=e.querySelector('input[type="checkbox"]');var n;t.checked||((n=Array.from(o.options).find(e=>e.value===t.value))&&o.remove(n.index),e.remove())}),e.forEach(e=>{var t=parseInt(e.id,10);if(!d.includes(t)){var n=document.createElement("div");n.classList.add("tail--nested-dropdown-item");const c=document.createElement("input");c.type="checkbox",c.value=t,c.addEventListener("change",()=>{s(c)});var l=document.createElement("label"),a=document.createElement("span"),a=(a.textContent=e.text,l.appendChild(c),l.appendChild(a),n.appendChild(l),i.appendChild(n),new Option(e.text,t,!1,!1));o.add(a),0<d.length&&(l=i.querySelectorAll('input[type="checkbox"]:checked')[i.querySelectorAll('input[type="checkbox"]:checked').length-1].closest(".tail--nested-dropdown-item"),i.scrollTop=l.clientHeight*(d.length-1))}})}}).catch(e=>console.error("Error loading data:",e)))})})}};